#!/usr/bin/env bash
# Set kubectl context to specified GCP project with airflow namespace
# Usage: sixty-project <project-name>
#
# Example:
#   $ sixty-project sixty-capital-test
#   > Fetching cluster endpoint and auth data.
#   > kubeconfig entry generated for sixty-capital-test.
#   > context "gke_sixty-capital-test_us-east4-c_sixty-capital-test" modified.

set -e

if [[ -z "$1" ]]; then
    echo "Usage: sixty-project <project-name>" >&2
    exit 1
fi

gcloud container clusters get-credentials --project="$1" --zone=us-east4-c "$1"
kubectl config set-context "$(kubectl config current-context)" --namespace=airflow
